<!DOCTYPE html>
<html>
<head>
	<link rel ="stylesheet" href="localstorage.css">
	</head>
	<body>
		<div class ="wrapper">
			<h2>local tapas</h2>
		<ul class="plates">
			<li>loading tapas...</li>
		</ul>
		<form class ="add-items">
			<input type="text" name ="item" placeholder="item name" required><br><br>
			<input type="submit" value="+ADD ITEM">
		</form>
	</div>
    <script>
    	const addItems = document.querySelector('.add-items');
    	const itemsList = document.querySelector('.plates');
    	const items = JSON.parse(localStorage.getItem('items')) || [] ;

    	function addItem(e){
    		e.preventDefault();
    		const text=(this.querySelector('[name=item]')).value;
    		const item ={
    			text,
    			done: false
    		};
    		items.push(item);
    		populateList(items,itemsList);
    		localStorage.setItem('items', JSON.stringfy(items));
    		this.reset();
    	}
    	function populateList(plates = [], platesList){
    		platesList.innerHTML = plates.map((plate,i)=>
    		{
    			return`
    			<li>
    			<input type ="checkbox" data-index=${i} id="item${i} ${plate.done? 'checked': ''}/>
    			<label for="item${i}">${plate.text}</label>
    			</li>`;
    		}).join('');
           }
    		
    	function toggleDone(e){
    		if(!e.target.matches('input')) return;
    		const e1 =e.target;
    		const index = e1.dataset.index;
    		items[index].done = !items[index].done;
            localStorage.setItem('items', JSON.stringfy(items));
            populateList(items, itemsList);
    	}
    	addItems.addEventListener('submit' ,addItem);
    	addItems.addEventListener('click' ,toggleDone);
    </script>


	</body>
</html>